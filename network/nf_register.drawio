<mxfile host="Electron" modified="2023-10-18T07:25:35.764Z" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/21.6.5 Chrome/114.0.5735.243 Electron/25.3.1 Safari/537.36" etag="pONT4ZZPO9AKtoVyyV5b" version="21.6.5" type="device">
  <diagram name="第 1 页" id="HeUKaDDaq521nx4wqFQZ">
    <mxGraphModel dx="1499" dy="844" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="x67kKdyZGz1WuYS3fvdA-1" value="struct net" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="50" y="180" width="450" height="30" as="geometry" />
        </mxCell>
        <mxCell id="x67kKdyZGz1WuYS3fvdA-2" value="struct netns_nf nf" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="50" y="210" width="430" height="30" as="geometry" />
        </mxCell>
        <mxCell id="x67kKdyZGz1WuYS3fvdA-3" value="struct nf_hook_entries *hooks_ipv4[NF_INET_NUMHOOKS]" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="50" y="240" width="410" height="30" as="geometry" />
        </mxCell>
        <mxCell id="x67kKdyZGz1WuYS3fvdA-30" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" edge="1" parent="1" source="x67kKdyZGz1WuYS3fvdA-4" target="x67kKdyZGz1WuYS3fvdA-9">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="x67kKdyZGz1WuYS3fvdA-4" value="struct nf_hook_entries * // NF_INET_PRE_ROUTING" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="50" y="270" width="390" height="30" as="geometry" />
        </mxCell>
        <mxCell id="x67kKdyZGz1WuYS3fvdA-5" value="struct nf_hook_entries * // NF_INET_LOCAL_IN" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="50" y="300" width="390" height="30" as="geometry" />
        </mxCell>
        <mxCell id="x67kKdyZGz1WuYS3fvdA-6" value="struct nf_hook_entries * // NF_INET_FORWARD" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="50" y="330" width="390" height="30" as="geometry" />
        </mxCell>
        <mxCell id="x67kKdyZGz1WuYS3fvdA-7" value="struct nf_hook_entries * // NF_INET_LOCAL_OUT" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="50" y="360" width="390" height="30" as="geometry" />
        </mxCell>
        <mxCell id="x67kKdyZGz1WuYS3fvdA-9" value="struct nf_hook_entries&amp;nbsp;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="620" y="270" width="390" height="30" as="geometry" />
        </mxCell>
        <mxCell id="x67kKdyZGz1WuYS3fvdA-10" value="u16 num_hooks_entries" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="620" y="300" width="370" height="30" as="geometry" />
        </mxCell>
        <mxCell id="x67kKdyZGz1WuYS3fvdA-11" value="struct nf_hook_entry hooks[num]" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="620" y="330" width="370" height="30" as="geometry" />
        </mxCell>
        <mxCell id="x67kKdyZGz1WuYS3fvdA-17" value="struct nf_hook_ops * ops [num]" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="620" y="480" width="370" height="30" as="geometry" />
        </mxCell>
        <mxCell id="x67kKdyZGz1WuYS3fvdA-20" value="struct&amp;nbsp; nf_hook_entries_rcu_head" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="620" y="750" width="370" height="30" as="geometry" />
        </mxCell>
        <mxCell id="x67kKdyZGz1WuYS3fvdA-21" value="struct nf_hook_entries * // NF_INET_POST_ROUTING" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="50" y="390" width="390" height="30" as="geometry" />
        </mxCell>
        <mxCell id="x67kKdyZGz1WuYS3fvdA-31" value="struct nf_hook_ops *&amp;nbsp; &amp;nbsp;// 第一个hook函数对应的具体ops" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="620" y="510" width="340" height="30" as="geometry" />
        </mxCell>
        <mxCell id="x67kKdyZGz1WuYS3fvdA-32" value="struct nf_hook_entry&amp;nbsp; &amp;nbsp;// 第一个hook函数" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="620" y="360" width="340" height="30" as="geometry" />
        </mxCell>
        <mxCell id="x67kKdyZGz1WuYS3fvdA-33" value="nf_hookfn" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="620" y="390" width="300" height="30" as="geometry" />
        </mxCell>
        <mxCell id="x67kKdyZGz1WuYS3fvdA-34" value="void *priv" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="620" y="420" width="300" height="30" as="geometry" />
        </mxCell>
        <mxCell id="x67kKdyZGz1WuYS3fvdA-35" value="nf_hookfn *hook" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="620" y="540" width="300" height="30" as="geometry" />
        </mxCell>
        <mxCell id="x67kKdyZGz1WuYS3fvdA-36" value="struct net_device *dev" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="620" y="570" width="300" height="30" as="geometry" />
        </mxCell>
        <mxCell id="x67kKdyZGz1WuYS3fvdA-37" value="void *priv" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="620" y="600" width="300" height="30" as="geometry" />
        </mxCell>
        <mxCell id="x67kKdyZGz1WuYS3fvdA-38" value="u_int8_t pf" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="620" y="630" width="300" height="30" as="geometry" />
        </mxCell>
        <mxCell id="x67kKdyZGz1WuYS3fvdA-39" value="unsigned int hooknum" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="620" y="660" width="300" height="30" as="geometry" />
        </mxCell>
        <mxCell id="x67kKdyZGz1WuYS3fvdA-40" value="int priority" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="620" y="690" width="300" height="30" as="geometry" />
        </mxCell>
        <mxCell id="x67kKdyZGz1WuYS3fvdA-41" value="struct nf_hook_entry&amp;nbsp; // 第二个hook函数" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="620" y="450" width="340" height="30" as="geometry" />
        </mxCell>
        <mxCell id="x67kKdyZGz1WuYS3fvdA-42" value="struct nf_hook_ops *&amp;nbsp;&amp;nbsp;// 第二个hook函数对应的具体ops" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="620" y="720" width="340" height="30" as="geometry" />
        </mxCell>
        <mxCell id="x67kKdyZGz1WuYS3fvdA-43" value="hooks 根据 ops-&amp;gt;priority 降序排列" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="940" y="410" width="200" height="30" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
